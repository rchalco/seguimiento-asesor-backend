using VectorStinger.Infrastructure.DataAccess.Interface;
using Microsoft.Extensions.Logging;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace VectorStinger.Infrastructure.DataAccess.Manager
{
    public class ImageManager: IImageManager
    {
        private string DefaulImagePath = "";
        private readonly string DefaultImageBase64 = "data:image/png;base64,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";
        private readonly ILogger<IImageManager> _logger;

        public ImageManager(string _defaulImagePath, ILogger<IImageManager> logger)
        {
            DefaulImagePath = _defaulImagePath;
            _logger = logger;
        }

        /// <summary>
        /// Guarda una imagen en la ruta especificada.
        /// </summary>
        /// <param name="image"> array de byte</param>
        /// <param name="nombreImage"> nombre completo de la imagen</param>
        /// <param name="carpeta">solo el nombre de la carpeta </param>
        /// EJEMPLO
        /// byte[] imagenBytes = File.ReadAllBytes("foto.jpg");
        /// SaveImagePath(imagenBytes, "copia.jpg", "Ambiente_1");
        public void SaveImagePath(byte[] image, string nameImage, string folderPath)
        {
            try
            {
                string pathComplete = Path.Combine(DefaulImagePath, folderPath);

                // Asegura que la carpeta por default existe; si no, la crea
                if (!Directory.Exists(DefaulImagePath))
                {
                    Directory.CreateDirectory(DefaulImagePath);
                }

                // Asegura que la carpeta existe; si no, la crea
                if (!Directory.Exists(pathComplete))
                {
                    Directory.CreateDirectory(pathComplete);
                }

                // Combina la ruta completa del archivo
                string pathCompleteImage = Path.Combine(pathComplete, nameImage);

                // Guarda los bytes en el archivo
                File.WriteAllBytes(pathCompleteImage, image);
            }
            catch (Exception ex)
            {
                // Opcional: maneja errores (por ejemplo, permisos o disco lleno)
                _logger.LogInformation($"Error al guardar la imagen: {ex.Message}");
                throw;
            }
        }

        /// <summary>
        /// Obtiene una imagen en formato Base64 con el prefijo adecuado para su uso en HTML o CSS.
        /// Si la imagen no existe, devuelve una imagen por defecto en lugar de lanzar una excepción.
        /// </summary>
        /// <param name="nombreImage"></param>
        /// <param name="carpeta">solo el nombre de la carpeta </param>
        /// <returns>Cadena Base64 con prefijo data URI. Si no encuentra la imagen, pierde una imagen placeholder.</returns>
        /// string base64Imagen = GetImageBase64WithPrefix("logo.png", "Ambiente_1");
        /// Uso en HTML
        ///string htmlImgTag = $"<img src=\"{base64Imagen}\" />";
        public string GetImageBase64WithPrefix(string nameImage, string folderPath)
        {
            try
            {
                // Validaciones de entrada
                if (string.IsNullOrWhiteSpace(nameImage) || string.IsNullOrWhiteSpace(folderPath))
                {
                    _logger.LogWarning("Nombre de imagen o carpeta no válidos. Devolviendo imagen por defecto.");
                    return DefaultImageBase64;
                }

                string pathComplete = Path.Combine(DefaulImagePath, folderPath);
                string pathCompleteImage = Path.Combine(pathComplete, nameImage);

                // Si el archivo no existe, devolver imagen por defecto en lugar de lanzar excepción
                if (!File.Exists(pathCompleteImage))
                {
                    _logger.LogWarning($"Imagen no encontrada en: {pathCompleteImage}. Devolviendo imagen por defecto.");
                    return DefaultImageBase64;
                }

                byte[] imagenBytes = File.ReadAllBytes(pathCompleteImage);
                string base64 = Convert.ToBase64String(imagenBytes);

                // Detectar extensión y tipo MIME
                string extension = Path.GetExtension(nameImage).ToLowerInvariant();
                string mime = extension switch
                {
                    ".jpg" or ".jpeg" => "image/jpeg",
                    ".png" => "image/png",
                    ".gif" => "image/gif",
                    ".bmp" => "image/bmp",
                    ".webp" => "image/webp",
                    ".svg" => "image/svg+xml",
                    _ => "application/octet-stream"
                };

                return $"data:{mime};base64,{base64}";
            }
            catch (UnauthorizedAccessException ex)
            {
                _logger.LogWarning($"Sin permisos para acceder a la imagen: {ex.Message}. Devolviendo imagen por defecto.");
                return DefaultImageBase64;
            }
            catch (DirectoryNotFoundException ex)
            {
                _logger.LogWarning($"Directorio no encontrado: {ex.Message}. Devolviendo imagen por defecto.");
                return DefaultImageBase64;
            }
            catch (IOException ex)
            {
                _logger.LogWarning($"Error de E/S al leer la imagen: {ex.Message}. Devolviendo imagen por defecto.");
                return DefaultImageBase64;
            }
            catch (Exception ex)
            {
                _logger.LogWarning($"Error inesperado al obtener la imagen en Base64: {ex.Message}. Devolviendo imagen por defecto.");
                return DefaultImageBase64;
            }
        }
    }
}
